!-----------------------------------------------------------------------------
! (c) Crown copyright 2022 Met Office. All rights reserved.
! The file LICENCE, distributed with this code, contains details of the terms
! under which the code may be used.
!-----------------------------------------------------------------------------

!>@brief Simple algorithm to help the development of da_dev
module da_dev_increment_alg_mod

  use constants_mod,                  only: r_def
  use log_mod,                        only: log_event,         &
                                            LOG_LEVEL_INFO
  use field_mod,                      only: field_type

  implicit none

  private

  public :: da_dev_increment_alg

contains

  !> @brief  An algorithm for testing da_dev
  !> @param[inout] field  A prognostic field object
  subroutine da_dev_increment_alg(field)

    implicit none

    real(r_def) :: increment = 1.0

    ! Prognostic fields
    type( field_type ), intent( inout ) :: field

    call log_event( "da_dev: Running algorithm", LOG_LEVEL_INFO )

    call invoke( inc_a_plus_x( increment, field ) )

    call log_event( "da_dev: finished algorithm", LOG_LEVEL_INFO )

  end subroutine da_dev_increment_alg

end module da_dev_increment_alg_mod
