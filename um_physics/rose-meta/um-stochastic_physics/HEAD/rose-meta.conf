#==============================================================================
# Stochastic Physics:
#==============================================================================

[namelist:stochastic_physics]
compulsory=true
description=Stochastic Physics
ns=namelist/Science/UM Stochastic Physics
sort-key=Section-A15
title=Stochastic Physics

[namelist:stochastic_physics=spt_n_max]
compulsory=true
description=Maximum wavenumber for the SPT forcing pattern
help=This value is the maximum wavenumber of the spectral
    =coefficients that define the forcing pattern
    =
    = It is recommended to have a value of 60 to only force
    = the planetary and synoptic scales.
    = Higher values may have a detrimental impact on the model
    = runtime and usage of computational resources.
ns=namelist/Science/UM Stochastic Physics/SPT
range=2:150
sort-key=Panel-A2a
type=integer

[namelist:stochastic_physics=spt_add_increments]
compulsory=true
description=Add increments to the flow
help=Set this to False for debugging purposes, increments will be
    =generated but these will not be added to the flow.
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A1
type=logical

[namelist:stochastic_physics=spt_convection_cfl_limit]
compulsory=true
description=Activate CFL constraint for convection increments
help=Check if the scaling of the convective mass flux by the
    =SPT forcing pattern breaches the CFL limit. If it does,
    =then the SPT perturbations are removed from this gridpoint.
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A3a
type=logical

[namelist:stochastic_physics=spt_decorrelation_time]
compulsory=true
description=Decorrelation time in SPT AR1 process
help=Tau is a decorrelation time (20000 sec = ~5.5 hrs is typical)
ns=namelist/Science/UM Stochastic Physics/SPT
range=1.0e3:1.0e7
sort-key=Panel-A2b
type=real

[namelist:stochastic_physics=spt_level_begin_tappering_bottom]
compulsory=true
description=Level where near-surface tappering starts
fail-if=this <= namelist:stochastic_physics=spt_level_bottom
help=At this level the lower tappering begins, going down from here to
    = spt_level_bottom as
    =
    =  (k - spt_level_bottom) /
    =  (spt_level_begin_tappering_bottom - spt_level_bottom)
    =
    = Where k is the level number, hence spt_level_begin_tappering_bottom
    = level still has an amplitude of 1 and spt_level_bottom of 0.
ns=namelist/Science/UM Stochastic Physics/SPT
range=2:60
sort-key=Panel-A6b
type=integer

[namelist:stochastic_physics=spt_level_begin_tappering_top]
compulsory=true
description=Level where near-top tappering starts
fail-if=this >= namelist:stochastic_physics=spt_level_top
help=At this level the upper tappering begins, going up from here to
    = spt_level_top as
    =
    =  (k - spt_level_tappering_top) /
    =  (spt_level_top - spt_level_tappering_top)
    =
    = Where k is the level number, hence spt_level_begin_tappering_top
    = level still has an amplitude of 1 and spt_level_top of 0.
ns=namelist/Science/UM Stochastic Physics/SPT
range=30:200
sort-key=Panel-A6c
type=integer

[namelist:stochastic_physics=spt_level_bottom]
compulsory=true
description=Bottom level where SPT is active
           =See Help panel for details
help=Bottom level wehre SPT perturbations are applied.
    =Though, the tappering at this level is 0 so effectively
    =SPT perturbations start one level above, see help-panel
    = of spt_level_begin_tappering_bottom.
ns=namelist/Science/UM Stochastic Physics/SPT
range=2:60
sort-key=Panel-A6a
type=integer

[namelist:stochastic_physics=spt_level_top]
compulsory=true
description=Top level where SPT is active
           =See Help panel for details
help=Top level where SPT perturbations are applied.
    =Though, the tappering at this level is 0 so effectively
    =SPT perturbations start one level below, see help-panel
    = of spt_level_begin_tappering_top.
ns=namelist/Science/UM Stochastic Physics/SPT
range=30:200
sort-key=Panel-A6d
type=integer

[namelist:stochastic_physics=spt_moisture_conservation]
compulsory=true
description=Activate water conservation in the column
help=It makes SPT to conserve the specific humidity q in the model column.
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A3b
type=logical

[namelist:stochastic_physics=spt_mse_conservation]
compulsory=true
description=Activate MSE conservation
help=It links SPT theta increments to q increments to conserve Moist Static Energy.
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A3c
type=logical

[namelist:stochastic_physics=spt_n_smoothing_iters]
compulsory=true
description=Number of smoothing iterations for the SPT pert
help=The number of iterations for the 1-2-1 filter to the SPT perturbations
ns=namelist/Science/UM Stochastic Physics/SPT
range=0:10
sort-key=Panel-A5
type=integer

[namelist:stochastic_physics=spt_orog_forcing_pattern_thresh]
compulsory=true
description=Capping SPT pert above ABS(fp) and stddev_orog_thres
help=Set the threshold for the absolute value of the Forcing Pattern (FP)
    = for SPT orographic capping.
    = SPT perturbation are removed if FP >= spt_orog_forcing_pattern_thresh in areas
    = where the standard deviation of subgrid orography is higher than the
    = 'stddev_orog_thres' parameter (also contained in the 'namelist:stochastic_physics').
    = The default value is 0.5.
ns=namelist/Science/UM Stochastic Physics/SPT
range=0.1:1.0
sort-key=Panel-A3d
type=real

[!namelist:stochastic_physics=spt_spectral_dim]
compulsory=false
description=SPT spectral dimension
expression=(namelist:stochastic_physics=spt_n_max + 1)*(namelist:stochastic_physics=spt_n_max + 2)/2
help= The dimension of the spectral coefficients of the stochastic Forcing Pattern.
    = As the (N+1)x(N+1) matrix of spectral coefficients x spherical harmonics is a triangular 
    = matrix as below, where N is max. wavenumber (spt_n_max)
    =
    = -------------------------------
    = |  0  |     |     |     |     |
    = |  1  |  2  |     |     |     |
    = |  3  |  4  |  5  |     |     |
    = |  6  |  7  |  8  |  9  |     |
    = | 10  | 11  | 12  | 13  | 14  |
    = -------------------------------
    =
    = It can be reshape to a vector of dimensions 
    = (N+1) + ((N+1)*2-(N+1))/2 = (N+1)*(N+2)/2
    = For the diagonal, and lower half minus diagonal.
ns=namelist/Science/UM Stochastic Physics/SPT
type=integer

[namelist:stochastic_physics=spt_stddev_convection]
compulsory=true
description=Std dev. for the SPT perturbations to the Convection tendency
help=The Standard deviation of the forcing pattern applied to the
    =Convection tendencies. To scale the pertubation
ns=namelist/Science/UM Stochastic Physics/SPT
range=0.01:10
sort-key=Panel-A13b
type=real

[namelist:stochastic_physics=spt_stddev_microphysics]
compulsory=true
description=Std dev. for the SPT perturbations to the Microphysics tendency
help=The Standard deviation of the forcing pattern applied to the
    =Microphysics tendencies. To scale the pertubation
ns=namelist/Science/UM Stochastic Physics/SPT
range=0.01:10
sort-key=Panel-A12b
type=real

[namelist:stochastic_physics=spt_stddev_orog_thres]
compulsory=true
description=Capping SPT pert. above this value of subgrid std. dev. of orography
help=This parameter sets the threshold for the standard deviation of subgrid orography (sigma_orog)
    = for SPT orographic capping.
    = SPT perturbations are removed in areas where sigma_orog >= stddev_orog_thres and
    = when the absolute value of the forcing pattern is above the namelist:stochastic_physics
    = parameter 'spt_orog_forcing_pattern_thresh'. The default value is 500m
ns=namelist/Science/UM Stochastic Physics/SPT
range=100.0:4000.0
sort-key=Panel-A3b
type=real

[namelist:stochastic_physics=spt_stddev_radiation]
compulsory=true
description=Std dev. for the SPT perturbations to the Radiation tendency
help=The Standard deviation of the forcing pattern applied to the
    =Radiative tendencies. To scale the pertubation
ns=namelist/Science/UM Stochastic Physics/SPT
range=0.01:10
sort-key=Panel-A11b
type=real

[namelist:stochastic_physics=spt_use_convection]
compulsory=true
description=Apply SPT perturbations to the T and q tendencies from convection
help=If false it does not add the perturbations from q and T of conv.tendencies
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A13
trigger=namelist:stochastic_physics=spt_stddev_convection: .true. ;
type=logical

[namelist:stochastic_physics=spt_use_microphysics]
compulsory=true
description=Apply SPT perturbations to the T and q tendencies from Microphysics
help=If false it does not add the perturbations from q and T of microphysics
    = (a.k.a. Large-Scale rain) tendencies
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A12
trigger=namelist:stochastic_physics=spt_stddev_microphysics: .true. ;
type=logical

[namelist:stochastic_physics=spt_use_radiation]
compulsory=true
description=Apply SPT perturbations to the T and q tendencies from Radiation
help=If false it does not add the perturbations from q and T of Rad. tendencies
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A11
trigger=namelist:stochastic_physics=spt_stddev_radiation: .true. ;
type=logical

[namelist:stochastic_physics=use_spt]
compulsory=true
description=Switch controls use of SPT scheme
help=Main switch to control use of Stochastic Perturbation of Tendencies (SPT) scheme
ns=namelist/Science/UM Stochastic Physics/SPT
sort-key=Panel-A
trigger=namelist:stochastic_physics=spt_add_increments: .true. ;
       =namelist:stochastic_physics=spt_use_radiation: .true.;
       =namelist:stochastic_physics=spt_stddev_radiation: .true.;
       =namelist:stochastic_physics=spt_use_microphysics: .true.;
       =namelist:stochastic_physics=spt_stddev_microphysics: .true.;
       =namelist:stochastic_physics=spt_use_convection: .true.;
       =namelist:stochastic_physics=spt_stddev_convection: .true.;
       =namelist:stochastic_physics=spt_convection_cfl_limit: .true. ;
       =namelist:stochastic_physics=spt_moisture_conservation: .true. ;
       =namelist:stochastic_physics=spt_mse_conservation: .true. ;
       =namelist:stochastic_physics=spt_level_bottom: .true. ;
       =namelist:stochastic_physics=spt_level_begin_tappering_bottom: .true. ;
       =namelist:stochastic_physics=spt_level_begin_tappering_top: .true. ;
       =namelist:stochastic_physics=spt_level_top: .true. ;
       =namelist:stochastic_physics=spt_n_smoothing_iters: .true. ;
       =namelist:stochastic_physics=spt_stddev_orog_thres: .true. ;
       =namelist:stochastic_physics=spt_orog_forcing_pattern_thresh: .true. ;
       =namelist:stochastic_physics=spt_decorrelation_time: .true. ;
       =namelist:stochastic_physics=spt_n_max: .true. ;
type=logical
