[command]
default=rose mpi-launch scintelapi.exe lfric.nl scintelapi.nl io.nl

[env]
MESH_FILE_PATH=$LFRIC_MESH_FILE
SOURCE_DUMP_PATH=$SOURCE_DUMP

[file:input_mesh_faces.nc]
source=$MESH_FILE_PATH

[file:io.nl]
source=namelist:iofiles

[file:lfric.nl]
source=namelist:base_mesh namelist:extrusion namelist:finite_element
      =namelist:planet
      =namelist:partitioning
      =namelist:domain_size
      =namelist:formulation

[file:scintelapi.nl]
source=namelist:field_definitions(:) namelist:dependency_graphs(:)

[file:source_dump.nc]
source=$SOURCE_DUMP_PATH

[namelist:base_mesh]
f_lat_deg=45.0
filename='input_mesh_faces.nc'
fplane=.false.
geometry='spherical'
offline_partitioning=.false.
prime_mesh_name='$LFRIC_MESH_NAME'
topology='fully_periodic'

[namelist:dependency_graphs(01)]
generator='init_field'
genpar='30.0'
!!input_fields=
output_fields='wind_speed'

[namelist:dependency_graphs(02)]
generator='a_times_X'
genpar='0.65'
input_fields='wind_speed'
output_fields='ns_wind'

[namelist:dependency_graphs(03)]
generator='X_minus_Y'
!!genpar=
input_fields='wind_speed','ns_wind'
output_fields='ew_wind'

[namelist:dependency_graphs(04)]
generator='init_field'
genpar='mdi'
!!input_fields=
output_fields='upward_wind'

[namelist:dependency_graphs(05)]
generator='read_from_file'
genpar='theta_in_wtheta'
!!input_fields=
output_fields='theta_from_dump'

[namelist:dependency_graphs(06)]
generator='X_powreal_a'
genpar='1.15'
input_fields='theta_from_dump'
output_fields='theta'

[namelist:dependency_graphs(07)]
generator='read_from_file'
genpar='dry_rho_in_w3'
!!input_fields=
output_fields='dry_rho_from_dump'

[namelist:dependency_graphs(08)]
generator='X_powint_n'
genpar='1'
input_fields='dry_rho_from_dump'
output_fields='dry_rho'

[namelist:dependency_graphs(09)]
generator='read_from_file'
genpar='tstar'
!!input_fields=
output_fields='tstar_from_dump'

[namelist:dependency_graphs(10)]
generator='X_times_Y'
!!genpar=
input_fields='tstar_from_dump','land_fraction_from_ancil'
output_fields='tstar'

[namelist:dependency_graphs(11)]
generator='init_field'
genpar='1.0'
!!input_fields=
output_fields='unit_field_wtheta'

[namelist:dependency_graphs(12)]
generator='read_from_file'
genpar='ozone_in_wtheta'
!!input_fields=
output_fields='ozone_from_dump'

[namelist:dependency_graphs(13)]
generator='X_times_Y'
!!genpar=
input_fields='ozone_from_dump','unit_field_wtheta'
output_fields='ozone'

[namelist:dependency_graphs(14)]
generator='read_from_file'
genpar='mv_in_wtheta'
!!input_fields=
output_fields='mv_from_dump'

[namelist:dependency_graphs(15)]
generator='X_divideby_Y'
!!genpar=
input_fields='mv_from_dump','unit_field_wtheta'
output_fields='mv'

[namelist:dependency_graphs(16)]
generator='read_from_file'
genpar='mcl_in_wtheta'
!!input_fields=
output_fields='mcl_from_dump'

[namelist:dependency_graphs(17)]
generator='read_from_file'
genpar='mcf_in_wtheta'
!!input_fields=
output_fields='mcf_from_dump'

[namelist:dependency_graphs(18)]
generator='X_plus_Y'
!!genpar=
input_fields='mcl_from_dump','mcf_from_dump'
output_fields='total_cloud_water'

[namelist:dependency_graphs(19)]
generator='aX_plus_bY'
genpar='0.25 0.5'
input_fields='mcl_from_dump','mcf_from_dump'
output_fields='mcf'

[namelist:dependency_graphs(20)]
generator='X_minus_Y'
!!genpar=
input_fields='total_cloud_water','mcf_from_dump'
output_fields='mcl'

[namelist:dependency_graphs(21)]
generator='read_from_file'
genpar='land_area_fraction'
!!input_fields=
output_fields='land_fraction_from_ancil'

[namelist:dependency_graphs(22)]
generator='read_from_file'
genpar='vol_frac_con_water_wilt_point'
!!input_fields=
output_fields='soil_vol_frac_wat_wp_from_ancil'

[namelist:dependency_graphs(23)]
generator='read_from_file'
genpar='vol_frac_con_water_crit_point'
!!input_fields=
output_fields='soil_vol_frac_wat_cp_from_ancil'

[namelist:dependency_graphs(24)]
generator='init_field'
genpar='0.25'
!!input_fields=
output_fields='soil_moisture_stress_init'

[namelist:dependency_graphs(25)]
generator='soil_moist_stress_to_soil_moist_content'
!!genpar='0.65'
input_fields='soil_moisture_stress_init',
            ='soil_vol_frac_wat_cp_from_ancil',
            ='soil_vol_frac_wat_wp_from_ancil'
output_fields='soil_moisture_content'

[namelist:dependency_graphs(26)]
generator='soil_moist_content_to_soil_moist_stress'
!!genpar='0.65'
input_fields='soil_moisture_content','soil_vol_frac_wat_cp_from_ancil',
            ='soil_vol_frac_wat_wp_from_ancil'
output_fields='soil_moisture_stress'

[namelist:domain_size]
planar_domain_max_x=1.0
planar_domain_max_y=1.0
planar_domain_min_x=-1.0
planar_domain_min_y=-1.0

[namelist:extrusion]
domain_top=39254.833575999997
method='um_L38_29t_9s_40km'
number_of_layers=$NUMBER_OF_LAYERS

[namelist:field_definitions(dry_rho)]
field_id='dry_rho'
field_kind='W3_field'
write_name='dry_rho_in_w3'
write_to_dump='y'

[namelist:field_definitions(dry_rho_from_dump)]
field_id='dry_rho_from_dump'
field_kind='W3_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(ew_wind)]
field_id='ew_wind'
field_kind='W3_field'
write_name='ew_wind_in_w3'
write_to_dump='y'

[namelist:field_definitions(land_fraction_from_ancil)]
field_id='land_fraction_from_ancil'
field_kind='W3_field_2d'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(mcf)]
field_id='mcf'
field_kind='Wtheta_field'
write_name='mcf_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(mcf_from_dump)]
field_id='mcf_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(mcl)]
field_id='mcl'
field_kind='Wtheta_field'
write_name='mcl_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(mcl_from_dump)]
field_id='mcl_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(mv)]
field_id='mv'
field_kind='Wtheta_field'
write_name='mv_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(mv_from_dump)]
field_id='mv_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(ns_wind)]
field_id='ns_wind'
field_kind='W3_field'
write_name='ns_wind_in_w3'
write_to_dump='y'

[namelist:field_definitions(ozone)]
field_id='ozone'
field_kind='Wtheta_field'
write_name='ozone_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(ozone_from_dump)]
field_id='ozone_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(soil_moisture_content)]
field_id='soil_moisture_content'
field_kind='W3_soil_field'
n_data=4
write_name='soil_moisture_content'
write_to_dump='y'

[namelist:field_definitions(soil_moisture_stress)]
field_id='soil_moisture_stress'
field_kind='W3_soil_field'
n_data=4
write_name='soil_moisture_stress'
write_to_dump='y'

[namelist:field_definitions(soil_moisture_stress_init)]
field_id='soil_moisture_stress_init'
field_kind='W3_soil_field'
n_data=4
!!write_name=
write_to_dump='n'

[namelist:field_definitions(soil_vol_frac_wat_cp_from_ancil)]
field_id='soil_vol_frac_wat_cp_from_ancil'
field_kind='W3_field_2d'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(soil_vol_frac_wat_wp_from_ancil)]
field_id='soil_vol_frac_wat_wp_from_ancil'
field_kind='W3_field_2d'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(theta)]
field_id='theta'
field_kind='Wtheta_field'
write_name='theta_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(theta_from_dump)]
field_id='theta_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(total_cloud_water)]
field_id='total_cloud_water'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(tstar)]
field_id='tstar'
field_kind='W3_field_2d'
write_name='tstar'
write_to_dump='y'

[namelist:field_definitions(tstar_from_dump)]
field_id='tstar_from_dump'
field_kind='W3_field_2d'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(unit_field_wtheta)]
field_id='unit_field_wtheta'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(upward_wind)]
field_id='upward_wind'
field_kind='Wtheta_field'
write_name='upward_wind_in_wtheta'
write_to_dump='y'

[namelist:field_definitions(upward_wind_from_dump)]
field_id='upward_wind_from_dump'
field_kind='Wtheta_field'
!!write_name=
write_to_dump='n'

[namelist:field_definitions(wind_speed)]
field_id='wind_speed'
field_kind='W3_field'
write_to_dump='n'

[namelist:finite_element]
cellshape='quadrilateral'
coord_order=1
coord_system='xyz'
element_order=0
rehabilitate=.true.
vorticity_in_w1=.true.

[namelist:formulation]
l_multigrid=.false.
use_multires_coupling=.false.
use_physics=.true.

[namelist:iofiles]
ancil_file_map='land_area_ancil : ${BIG_DATA_DIR}/ancils/basic-gal/Quagga/${TARGET_GRID_RES}/n96e_l70/orca025/land_sea_mask/qrparm.landfrac.ugrid',
              ='soil_param_ancil : ${BIG_DATA_DIR}/ancils/basic-gal/Quagga/${TARGET_GRID_RES}/n96e_l70/soil_parameters/hwsd_vg/qrparm.soil.ugrid.fixed'
ancil_read=.true.
checkpoint_read=.true.
checkpoint_read_file='source_dump'
checkpoint_write=.true.
checkpoint_write_file='target_dump'

[namelist:partitioning]
panel_decomposition='auto'
partitioner='cubedsphere'

[namelist:planet]
cp=1005.0
gravity=9.80665
omega=7.292116E-5
p_zero=100000.0
radius=6371229.0
rd=287.05
scaling_factor=125.0
