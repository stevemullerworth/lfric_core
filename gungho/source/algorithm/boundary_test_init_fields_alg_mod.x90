!-----------------------------------------------------------------------------
! Copyright (c) 2017,  Met Office, on behalf of HMSO and Queen's Printer
! For further details please refer to the file LICENCE.original which you
! should have received as part of this distribution.
!-----------------------------------------------------------------------------

!>@brief Initialisation of fields for boundary test
module boundary_test_init_fields_alg_mod

  use log_mod,                         only: log_event,         &
                                             log_scratch_space, &
                                             LOG_LEVEL_INFO,    &
                                             LOG_LEVEL_TRACE
  use constants_mod,                   only: r_def, i_def


  ! Derived Types
  use field_mod,                       only: field_type

  implicit none

  private
  public :: boundary_test_init_fields_alg

contains
  !> @details An algorithm for initialising prognostic fields for 
  !>          all solvers.
  !> @param[inout] u  The 3D wind field
  !> @param[inout] rho The density
  !> @param[inout] theta The potential temperature
  !> @param[inout] xi The vorticity field 
  subroutine boundary_test_init_fields_alg(u, rho, theta, xi)

    implicit none

    type( field_type ), intent( inout ) :: u, rho, theta, xi

    !=== Initialise fields ==================================!

    call log_event( "Boundary test: Initialising fields", LOG_LEVEL_INFO )

    call invoke( set_field_scalar(0.0_r_def, xi),  &
                 set_field_scalar(0.0_r_def, u),   &
                 set_field_scalar(0.0_r_def, rho), & 
                 set_field_scalar(0.0_r_def, theta) )

    call log_event( "Boundary test: Initialised fields", LOG_LEVEL_INFO )

    !==========================================================================!

  end subroutine boundary_test_init_fields_alg

end module boundary_test_init_fields_alg_mod
